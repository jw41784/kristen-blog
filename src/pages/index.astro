---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const base = import.meta.env.BASE_URL;

// Get recent articles
const articles = await getCollection('articles', ({ data }) => {
  return data.draft !== true;
});

const recentArticles = articles
  .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf())
  .slice(0, 3);
---

<BaseLayout title="Home">
  <div class="space-y-8">
    <header class="text-center py-12">
      <h1 class="text-4xl sm:text-5xl font-bold mb-4">
        Hey, I'm Kristen
      </h1>
      <p class="text-xl text-zinc-600 dark:text-zinc-400 max-w-2xl mx-auto">
        I call out workplace BS (professionally) and help organizations actually listen to their people
      </p>
    </header>
    
    <section class="prose prose-zinc dark:prose-invert mx-auto">
      <p>
        Think your culture change initiative is going great? Your engagement scores look amazing? 
        Your employees are "highly satisfied"? Cool story. Let's talk about what's actually happening 
        behind those numbers.
        
        I'm an I/O psychologist who's spent 10+ years watching well-meaning leaders accidentally 
        create the exact opposite of what they intended. This is where I spill the tea on what 
        really works (spoiler: it's not more surveys).
      </p>
      
      <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center not-prose">
        <a href={`${base}articles/`} class="inline-block px-6 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors text-center">
          Let's go
        </a>
        <a href={`${base}about/`} class="inline-block px-6 py-3 border border-zinc-300 dark:border-zinc-700 rounded-lg hover:border-teal-600 dark:hover:border-teal-400 transition-colors text-center">
          The backstory
        </a>
      </div>
    </section>
    
    <section class="mt-16">
      <h2 class="text-2xl font-bold mb-6">Latest hot takes</h2>
      <div class="space-y-6">
        {recentArticles.map(article => (
          <article class="border-b border-zinc-200 dark:border-zinc-800 pb-6 last:border-0">
            <a href={`${base}articles/${article.slug}/`} class="group">
              <h3 class="text-xl font-semibold mb-2 group-hover:text-teal-600 dark:group-hover:text-teal-400 transition-colors">
                {article.data.title}
              </h3>
            </a>
            
            <div class="flex items-center gap-4 text-sm text-zinc-600 dark:text-zinc-400 mb-3">
              <time datetime={article.data.publishDate.toISOString()}>
                {article.data.publishDate.toLocaleDateString('en-US', {
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric'
                })}
              </time>
              <span>•</span>
              <span>{Math.ceil(article.body.split(' ').length / 200)} min read</span>
            </div>
            
            <p class="text-zinc-600 dark:text-zinc-400 mb-3">
              {article.data.description}
            </p>
            
            <div class="flex flex-wrap gap-2">
              {article.data.tags.map(tag => (
                <span class="px-2 py-1 text-xs rounded bg-zinc-100 dark:bg-zinc-800 text-zinc-700 dark:text-zinc-300">
                  {tag}
                </span>
              ))}
            </div>
          </article>
        ))}
      </div>
      
      <div class="text-center mt-8">
        <a href={`${base}articles/`} class="inline-block text-teal-600 dark:text-teal-400 hover:underline">
          Read all the things →
        </a>
      </div>
    </section>
  </div>
</BaseLayout>